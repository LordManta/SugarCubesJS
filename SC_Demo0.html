<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Demo Zero</title>
  <script type="text/javascript" src="SugarCubes.js">
  </script>
</head>
<body>
<script>
/*
First, one makes a logical clock which paces execution of a reactive system.
*/
const clck=SC.clock();

/*
As logical clock executes reactive programs.
One configures it to display a text showing instants elapsing:
1 -: 
2 -: 
3 -: 
4 -:
...
To do so, one uses an HTML pre element, and redirect stdout to that pre
element.
*/
clck.enablePrompt(true);
clck.setStdOut(SC.writeInConsole);
//const output=document.createElement("pre");
//document.body.appendChild(output);
//clck.setStdOut(function(msg){
//  output.innerText+=msg;
//  });

/*
Then, one makes an identifier of a reactive event called "e".
*/
const e=SC.evt("e");
/*
One can use that reactive event to build reactive programs :
 - the first one, in an inifinite loop is awaiting for the event e to be
   present and the instantaneously display a messgae on the stout, and so on...
 - the second, in another infinite loop is pausing for 5 consecutive instants
   and then instantaneously generates the reactive event e.
*/
const program1=SC.repeat(3, SC.await(e)
                              , SC.write("event &e is generated !\n"));
const program2=SC.repeat(3, SC.pause(5)
                              , SC.generate(e));
/*
Then, one adds the two programs into the reactive clock. This builds a program,
which is the parallel of the two added programs.
*/
clck.addProgram(program1);
clck.addProgram(program2);

/*
To get the execution thread, clock needs a processor which will make react the
clock for 20 consecutive instants.
*/
const power=SC.periodic({ delay: 1000 });
/*
One binds the clock to that processor.
*/
clck.bindTo(power);

var Sens_mouse_click=SC.sensor("Sens_mouse_click"
                         , {dom_targets: [
                               {
				 target: window
			       , evt: "click"
			       }
                                       ]
                         });

clck.addProgram(
  SC.repeatForever(
    SC.await(Sens_mouse_click)
  , SC.write('click!')
    )
  );
clck.bindTo(Sens_mouse_click);
</script>
</body>
</html>
